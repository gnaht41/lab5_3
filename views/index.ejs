<%- include('partials/header', { title: 'Home', user: user }) %>

<div class="text-center mt-5">
  <h1 class="mb-4">Welcome to My CRUD App</h1>
  <p class="lead">Browse products by supplier or search by name.</p>

  <div class="d-flex justify-content-center mt-4 mb-4">
    <form method="GET" action="/" class="d-flex">
      <select name="supplier" class="form-select me-2">
        <option value="">All Suppliers</option>
        <% suppliers.forEach(s => { %>
        <option value="<%= s._id %>" <%= s._id.toString() === selectedSupplier ? 'selected' : '' %>><%= s.name %></option>
        <% }) %>
      </select>
      <input type="text" name="search" class="form-control me-2" placeholder="Search product by name" value="<%= searchQuery %>">
      <button class="btn btn-outline-primary" type="submit">Search</button>
    </form>
  </div>

  <table class="table table-striped table-bordered mt-4">
    <thead class="table-dark">
      <tr>
        <th>Name</th>
        <th>Price</th>
        <th>Quantity</th>
        <th>Supplier</th>
      </tr>
    </thead>
    <tbody>
      <% products.forEach(p => { %>
      <tr>
        <td><%= p.name %></td>
        <td><%= p.price %></td>
        <td><%= p.quantity %></td>
        <td><%= p.supplierId ? p.supplierId.name : 'N/A' %></td>
      </tr>
      <% }) %>
    </tbody>
  </table>
</div>

<%- include('partials/footer') %>